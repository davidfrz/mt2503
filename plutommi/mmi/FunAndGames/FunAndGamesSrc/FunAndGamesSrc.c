/*****************************************************************************
*  Copyright Statement:
*  --------------------
*  This software is protected by Copyright and the information contained
*  herein is confidential. The software may not be copied and the information
*  contained herein may not be used or disclosed except with the written
*  permission of MediaTek Inc. (C) 2005
*
*  BY OPENING THIS FILE, BUYER HEREBY UNEQUIVOCALLY ACKNOWLEDGES AND AGREES
*  THAT THE SOFTWARE/FIRMWARE AND ITS DOCUMENTATIONS ("MEDIATEK SOFTWARE")
*  RECEIVED FROM MEDIATEK AND/OR ITS REPRESENTATIVES ARE PROVIDED TO BUYER ON
*  AN "AS-IS" BASIS ONLY. MEDIATEK EXPRESSLY DISCLAIMS ANY AND ALL WARRANTIES,
*  EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE IMPLIED WARRANTIES OF
*  MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE OR NONINFRINGEMENT.
*  NEITHER DOES MEDIATEK PROVIDE ANY WARRANTY WHATSOEVER WITH RESPECT TO THE
*  SOFTWARE OF ANY THIRD PARTY WHICH MAY BE USED BY, INCORPORATED IN, OR
*  SUPPLIED WITH THE MEDIATEK SOFTWARE, AND BUYER AGREES TO LOOK ONLY TO SUCH
*  THIRD PARTY FOR ANY WARRANTY CLAIM RELATING THERETO. MEDIATEK SHALL ALSO
*  NOT BE RESPONSIBLE FOR ANY MEDIATEK SOFTWARE RELEASES MADE TO BUYER'S
*  SPECIFICATION OR TO CONFORM TO A PARTICULAR STANDARD OR OPEN FORUM.
*
*  BUYER'S SOLE AND EXCLUSIVE REMEDY AND MEDIATEK'S ENTIRE AND CUMULATIVE
*  LIABILITY WITH RESPECT TO THE MEDIATEK SOFTWARE RELEASED HEREUNDER WILL BE,
*  AT MEDIATEK'S OPTION, TO REVISE OR REPLACE THE MEDIATEK SOFTWARE AT ISSUE,
*  OR REFUND ANY SOFTWARE LICENSE FEES OR SERVICE CHARGE PAID BY BUYER TO
*  MEDIATEK FOR SUCH MEDIATEK SOFTWARE AT ISSUE. 
*
*  THE TRANSACTION CONTEMPLATED HEREUNDER SHALL BE CONSTRUED IN ACCORDANCE
*  WITH THE LAWS OF THE STATE OF CALIFORNIA, USA, EXCLUDING ITS CONFLICT OF
*  LAWS PRINCIPLES.  ANY DISPUTES, CONTROVERSIES OR CLAIMS ARISING THEREOF AND
*  RELATED THERETO SHALL BE SETTLED BY ARBITRATION IN SAN FRANCISCO, CA, UNDER
*  THE RULES OF THE INTERNATIONAL CHAMBER OF COMMERCE (ICC).
*
*****************************************************************************/

/*****************************************************************************
 *
 * Filename:
 * ---------
 *   FunAndGamesSrc.c
 *
 * Project:
 * --------
 *   MAUI
 *
 * Description:
 * ------------
 *   Fun And Game source file
 *
 * Author:
 * -------
 * -------
 * -------
 * -------
 *
 *============================================================================
 *             HISTORY
 * Below this line, this part is controlled by PVCS VM. DO NOT MODIFY!!
 *------------------------------------------------------------------------------
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 * removed!
 * removed!
 *
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 *------------------------------------------------------------------------------
 * Upper this line, this part is controlled by PVCS VM. DO NOT MODIFY!!
 *============================================================================
 ****************************************************************************/

#include "MMI_features.h"
#include "wgui_inline_edit.h"
#include "MMIDataType.h"
#include "kal_general_types.h"
#include "GlobalConstants.h"
#include "mmi_frm_events_gprot.h"
#include "FunAndGamesResDef.h"
#include "mmi_frm_history_gprot.h"
#include "CustMenuRes.h"
#if defined(__PLUTO_MMI_PACKAGE__)
#include "mmi_rp_app_mainmenu_def.h"
#endif
#include "wgui_categories_util.h"
#include "wgui_fixed_menus.h"
#include "wgui_categories_list.h"
#include "GlobalResDef.h"
#include "BTMMIA2DPScr.h"
#include "AlertScreen.h"
#include "CommonScreensResDef.h"
#include "CommonScreens.h"
#include "FunAndGamesProts.h"
#include "GameProts.h"

#if defined(__J2ME__) && defined(__MMI_APP_MANAGER_SUPPORT__)
#include "mmi_rp_app_java_def.h"
#endif

#if (defined(__MMI_3D_GAME_INTERGRAFX__) && defined(__PLUTO_MMI_PACKAGE__))
#include "ig3d_adaptation.h"
#if defined(__MMI_APP_MANAGER_SUPPORT__)
#include "mmi_rp_app_ig_3dgame_def.h"
#endif
#endif

#if defined(__MMI_3D_GAME__)
#include "Game3DGprot.h"
#endif 

#if defined(__MMI_PICTURE_EDITOR_SUPPORT__)
#include "PictureEditorProts.h"
#endif 

#if defined(__MMI_NCENTER_SUPPORT__) && defined(__PLUTO_MMI_PACKAGE__)
#include "vapp_ncenter_gprot.h"
#endif

#if defined(__MMI_MEDIA_PLAYER__)
#include "MediaPlayerGProt.h"
#else
#include "mdi_datatype.h"       /* dependent headers for AudioPlayerProt.h" */
#include "AudioPlayerProt.h"
#endif

#if defined(__MMI_IMAGE_VIEWER__)
#include "ImageViewerGprot.h"
#endif 

#if defined(__MMI_ATV_SUPPORT__)
#include "MobileTVPlayerGprot.h"
#endif
#if defined(__MMI_MOBILE_TV_CMMB_SUPPORT__)
#include "DTVPlayerGprot.h"
#endif

#if defined(__MMI_CAMCORDER__)
#include "mdi_datatype.h"       /* dependent headers for mdi_camera.h" */
#include "mdi_camera.h"
#include "mmi_features_camcorder.h"
#ifdef __COSMOS_MMI_PACKAGE__
#if defined(__LOW_COST_SUPPORT_COMMON__)
    #include "vapp_camco_express_gprot.h"
#else
    #include "vapp_camco_gprot.h"
#endif  
#else
#include "CamcorderGprot.h"
#endif
#endif /* defined(__MMI_CAMCORDER__) */

#if defined (__MMI_CAMERA__) && !defined(__MMI_CAMCORDER__)
#include "mdi_datatype.h"            /* dependent headers for mdi_camera.h" */
#include "mdi_camera.h"              
#include "CameraApp.h"
#endif /* defined (__MMI_CAMERA__) && !defined(__MMI_CAMCORDER__) */ 

#if defined( __MMI_BARCODEREADER__)
#include "barcodereadergprot.h"
#endif /* __MMI_BARCODEREADER__ */


#if defined(__MMI_VIDEO_PLAYER__) 
#include "VdoPlyGProt.h"
#endif 

#if defined (__MMI_VIDEO_RECORDER__) && !defined(__MMI_CAMCORDER__)
#include "VdoRecGProt.h"
#endif 

#if defined(__MMI_PHOTOEDITOR__)
#include "PhotoEditorGProt.h"
#endif 

#ifdef __MMI_FM_RADIO__
#include "FMRadioProt.h"
extern void mmi_fmrdo_skip_highlight_hdlr(S32 index);   /* defined in FMRadioSrc.c */
extern U16 mmi_fmrdo_check_chip_or_hide(U16 n_items, U16 *string_ids, U16 *icon_ids); /* defined in FMRadioSrc.c */

#endif /* __MMI_FM_RADIO__ */ 

#ifdef __MMI_AB_REPEATER__
#include "mdi_datatype.h"
#include "ABRepeaterProt.h"
#endif /* __MMI_AB_REPEATER__ */ 

#ifdef __MMI_SLIDESHOW__
#include "SlideShowGProt.h"
#endif

#if defined(__MMI_BCR__)
#include "BCRGProt.h"
#endif

#include "mmi_rp_app_funandgames_def.h"
#include "ModeSwitchSrvGprot.h"

#if defined(__PLST_SERVICE_DB_SUPPORT__)
extern srv_plst_init(void);
#endif
/***************************************************************************** 
* Constance
*****************************************************************************/


/***************************************************************************** 
* Struct
*****************************************************************************/


/***************************************************************************** 
* Global Variable
*****************************************************************************/

/***************************************************************************** 
* Local Variable
*****************************************************************************/

/***************************************************************************** 
* Local Function
*****************************************************************************/


/***************************************************************************** 
* External Function
*****************************************************************************/
extern kal_uint32 get_mids_avail_storage(void);

#if defined(__PLUTO_MMI_PACKAGE__)
/*****************************************************************************
 * FUNCTION
 *  mmi_fng_proc
 * DESCRIPTION
 *  
 * PARAMETERS
 *  void
 * RETURNS
 *  void
 *****************************************************************************/
mmi_ret mmi_fng_proc(mmi_event_struct* param)
{  
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
    
    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
    return MMI_RET_OK;
}
#endif

/*****************************************************************************
 * FUNCTION
 *  mmi_fng_entry_screen
 * DESCRIPTION
 *  entry FunAndGame menu
 * PARAMETERS
 *  void
 * RETURNS
 *  void
 *****************************************************************************/
void mmi_fng_entry_screen(void)
{
#if defined(__PLUTO_MMI_PACKAGE__)
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
    U16 ItemList[MAX_SUB_MENUS];
    U16 ItemIcons[MAX_SUB_MENUS];
    MMI_BOOL entry_ret;    
    U8 *guiBuffer;
    U16 nItems;
    U16 title_icon;
    MMI_ID gid;
    U16 title;

    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
    gid = mmi_frm_group_create(GRP_ID_ROOT, SCR_ID_FUNANDGAMEG_GROUP, mmi_fng_proc, NULL);
    mmi_frm_group_enter(gid, MMI_FRM_NODE_SMART_CLOSE_FLAG );
    
    entry_ret = mmi_frm_scrn_enter(gid, SCR3000_FUNANDGAMES, NULL, mmi_fng_entry_screen, MMI_FRM_UNKNOW_SCRN);
    if (!entry_ret)
    {
        return;
    }
    
    guiBuffer = mmi_frm_scrn_get_gui_buf(gid, SCR3000_FUNANDGAMES);
    
#if defined(__J2ME__) && defined(__MMI_APP_MANAGER_SUPPORT__)
    nItems = GetNumOfChild(MENU_ID_JAVA_SETTINGS);
    GetSequenceStringIds(MENU_ID_JAVA_SETTINGS, ItemList);
    GetSequenceImageIds(MENU_ID_JAVA_SETTINGS, ItemIcons);
    SetParentHandler(MENU_ID_JAVA_SETTINGS);
    RegisterHighlightHandler(ExecuteCurrHiliteHandler);    
#else
    nItems = GetNumOfChild(MAIN_MENU_FUNANDGAMES_MENUID);
    GetSequenceStringIds(MAIN_MENU_FUNANDGAMES_MENUID, ItemList);
    GetSequenceImageIds(MAIN_MENU_FUNANDGAMES_MENUID, ItemIcons);
    SetParentHandler(MAIN_MENU_FUNANDGAMES_MENUID);
#if defined(__MMI_FM_RADIO__)
    RegisterHighlightHandler(mmi_fmrdo_skip_highlight_hdlr);
    nItems = mmi_fmrdo_check_chip_or_hide(nItems, ItemList, ItemIcons);
#else /* defined(__MMI_FM_RADIO__)  */ 
    RegisterHighlightHandler(ExecuteCurrHiliteHandler);
#endif /* defined(__MMI_FM_RADIO__) */     
#endif

    /* MTK Leo add, mini_tab_bar */
#ifdef __MMI_WGUI_MINI_TAB_BAR__
    wgui_enable_mini_tab_bar(MAIN_MENU_FUNANDGAMES_MENUID);
#endif 
    /* MTK Leo end */

	/* when choose a  number shortcut in the list menu, access the menu directly */
	wgui_list_menu_enable_access_by_shortcut();
    
    #if defined(__MMI_OP01_MENU_NOSIM_LIST__) && (defined(__MMI_OP01_MENU_9MATRIX__) || defined(__MMI_OP01_MENU_12MATRIX__))
        #ifndef __MRE_AM__
/* under construction !*/
        #else
/* under construction !*/
        #endif
    #else
        #ifndef __MRE_AM__
            title_icon = GetRootTitleIcon(MAIN_MENU_FUNANDGAMES_MENUID);
        #else
            title_icon = GetRootTitleIcon(MAIN_MENU_EXTRA_MENUID);
        #endif
    #endif
    
#if defined(__J2ME__) && defined(__MMI_APP_MANAGER_SUPPORT__)
    title = STR_GLOBAL_SETTINGS;
#elif defined(__J2ME__) && defined(__MMI_VUI_3D_MAINMENU__)
    title = STR_SCR_JAVA_CAPTION;
#else
    title = STR_SCR3000_FUNANDGAMES_CAPTION;
#endif

    ShowCategory52Screen(
        title,
        title_icon,
        STR_GLOBAL_OK,
        IMG_GLOBAL_OK,
        STR_GLOBAL_BACK,
        IMG_GLOBAL_BACK,
        nItems,
        ItemList,
        ItemIcons,
        0,
        0,
        0,
        guiBuffer);
    if (nItems == 0)
    {
        ChangeLeftSoftkey(0, 0);
        SetLeftSoftkeyFunction(NULL, KEY_EVENT_UP);
    }

	SetRightSoftkeyFunction(mmi_frm_scrn_close_active_id, KEY_EVENT_UP);
#endif /* defined(__PLUTO_MMI_PACKAGE__) */
}


/*****************************************************************************
 * FUNCTION
 *  mmi_fng_init_app
 * DESCRIPTION
 *  
 * PARAMETERS
 *  void
 * RETURNS
 *  void
 *****************************************************************************/
void mmi_fng_init_app(void)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/

    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
#if 0
#if defined(__MMI_MOTION_APP__)
/* under construction !*/
#endif /* defined(__MMI_MOTION_APP__) */ /* __MMI_GAME__ */
#endif

#if defined(__PLST_SERVICE_DB_SUPPORT__)
    srv_plst_init();
#endif

#ifdef __PLUTO_MMI_PACKAGE__
#if defined(__MMI_MEDIA_PLAYER__)

    mmi_medply_init_app();
#else

#if defined(__MMI_AUDIO_PLAYER__)
    InitAudioPlayerApp();
#endif 
    mmi_audply_init_single_play();

#endif /*__MMI_MEDIA_PLAYER__*/
#endif /* __PLUTO_MMI_PACKAGE__ */

#if defined(__MMI_A2DP_SUPPORT__) && !defined( __MMI_A2DP_HIDE_BT_SETTINGS__)
    mmi_a2dp_read_bt_settings();
#endif


#if defined( __MMI_BARCODEREADER__)
    mmi_barcodereader_init_app();
#endif /* __MMI_BARCODEREADER__ */

#if defined(__MMI_ATV_SUPPORT__) && !defined(__COSMOS_MMI_PACKAGE__)
    mmi_mtv_player_init_app();
#endif

#if defined(__MMI_MOBILE_TV_CMMB_SUPPORT__) && !defined(__COSMOS_MMI_PACKAGE__)
    mmi_dtv_player_init_app();
#endif

#ifdef __MMI_AB_REPEATER__
    InitABRepeaterApp();
#endif 

#if defined(__MMI_CAMCORDER__) && !defined(__COSMOS_MMI_PACKAGE__)
    mmi_camco_init_app();
#endif

#if defined(__MMI_CAMERA__) && !defined(__MMI_CAMCORDER__)
    mmi_camera_init_app();
#endif 

#if defined(__MMI_IMAGE_VIEWER__)
    mmi_imgview_init_app();
#endif 

#if defined(__MMI_VIDEO_PLAYER__) 
    mmi_vdoply_init_app();
#endif 

#if defined(__MMI_VIDEO_RECORDER__) && !defined(__MMI_CAMCORDER__)
    mmi_vdorec_init_app();
#endif 

#if defined(__MMI_PHOTOEDITOR__)
    mmi_phoedt_init_app();
#endif 

    /* [Tim][FM Radio] begin */
#ifdef __MMI_FM_RADIO__
    mmi_fmrdo_init_app();
#endif 
    /* [Tim][FM Radio] end */


#if defined(__MMI_PICTURE_EDITOR_SUPPORT__)
    InitPictureEditor();
#endif /* defined(__MMI_PICTURE_EDITOR_SUPPORT__) */

#if defined(__J2ME__)
    InitJAVA();
#endif 

#if defined(__MMI_SLIDESHOW__)
    mmi_slidshow_init_app();
#endif

#if defined(__MMI_BCR__)
    mmi_bcr_init_app();
#endif

}


/* NOTICE */
/* THIS FUNCTION should move to picture_editor's source, shall not put here */


/*****************************************************************************
 * FUNCTION
 *  Highlight_MENU_PICTURE_EDITOR
 * DESCRIPTION
 *  highlight picture editor
 * PARAMETERS
 *  void
 * RETURNS
 *  void
 *****************************************************************************/
/* Yogesh 01032004:  Added for Image Editor */
#ifdef __MMI_PICTURE_EDITOR_SUPPORT__
void Highlight_MENU_PICTURE_EDITOR(void)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/

    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
    SetLeftSoftkeyFunction(EntryScr4PicEditSelectMenu, KEY_EVENT_UP);
    SetKeyHandler(EntryScr4PicEditSelectMenu, KEY_RIGHT_ARROW, KEY_EVENT_DOWN);
}
#endif /* __MMI_PICTURE_EDITOR_SUPPORT__ */ 
/* End Added Yogesh 01032004 */


/*****************************************************************************
 * Intergrafx 3D games
 *****************************************************************************/
#if (defined(__MMI_3D_GAME_INTERGRAFX__) && defined(__PLUTO_MMI_PACKAGE__))
void mmi_fng_3d_game_intergrafx_hilight_hdlr(void);
void mmi_fng_entry_3d_game_intergrafx(void);
/*****************************************************************************
 * FUNCTION
 *  mmi_fng_intergrafx_3d_game_hilight_hdlr
 * DESCRIPTION
 *  highlight 3d game
 * PARAMETERS
 *  void
 * RETURNS
 *  void
 *****************************************************************************/
void mmi_fng_3d_game_intergrafx_hilight_hdlr(void)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/

    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
    SetLeftSoftkeyFunction(mmi_fng_entry_3d_game_intergrafx, KEY_EVENT_UP);
    EnableCenterSoftkey(0, IMG_GLOBAL_COMMON_CSK);
    SetCenterSoftkeyFunction(mmi_fng_entry_3d_game_intergrafx,KEY_EVENT_UP);
    SetKeyHandler(mmi_fng_entry_3d_game_intergrafx, KEY_RIGHT_ARROW, KEY_EVENT_DOWN);
}


#if defined(__VENUS_3D_UI_ENGINE__)

void mmi_fng_entry_3d_game_intergrafx(void)
{
#if	defined(__MMI_APP_MANAGER_SUPPORT__)
    g_IGAppID = APP_IG_3DGAME;
#else
    g_IGAppID = APP_FUNANDGAMES;
#endif




}

#else
static void mmi_entry_ig_scrn(void);

//////////////////////////////////////////////////////////////////////////////////


static void IGP_OnGameActivated(void)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
    //PU8 gui_buffer;
    IGPlatformConfig PC;

    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/

    g_iExited = 0;
    
    // determine if it's on phone call status
    #ifdef __MMI_BACKGROUND_CALL__
		if (srv_ucm_is_background_call())
            g_uIsOnPhoneCall = 1;
        else
        	g_uIsOnPhoneCall = 0;
    #endif    
/*
    if (!ig_engine_mem_buffer) 
    {
        ig_engine_mem_buffer = mmi_frm_asm_alloc_r(g_IGAppID, IG_3D_GAME_POOL_SIZE);
        MMI_ASSERT(ig_engine_mem_buffer);  //impossible
    }
*/
    //gui_buffer = GetCurrGuiBuffer(SCR_ID_IG_MAIN);

    gdi_layer_get_active(&g_IGNativeWindow);  // get active layer's handle
    gdi_layer_get_buffer_ptr(&g_pIGFrameBuffer);   // get frame buffer pointer 

    /* reset clip */
    gdi_layer_reset_clip();
    gdi_layer_reset_text_clip();

    /* enable multilayer */
    gdi_layer_multi_layer_enable();

    /* suspend background play */
    mdi_audio_suspend_background_play();

    /* set audio volumn */
    g_iSoundVol = 4;
    IGSound_SetVol(g_iSoundVol);

    /* stop MMI sleep */
    //srv_backlight_turn_on((gpio_backlight_time_enum) 0);

#ifdef __MMI_SUBLCD__
    /* draw game icon on sublcd */
    ForceSubLCDScreen(mmi_ig_draw_sublcd_icon);
#endif /* __MMI_SUBLCD__ */ 

    /* disalbe align timer, this will let timer more accurate */
    UI_disable_alignment_timers();

    ig_set_current_time();
    
    // register pen & keypad function
    IGSystem_RegisterTouchHandlers();

    IGDisplay_GetWindowSize((S32 *) &PC.m_uScrWidth, (S32 *) &PC.m_uScrHeight);

    PC.m_pFrameBuffer = g_pIGFrameBuffer;
    PC.m_pMemoryBuf = ig_engine_mem_buffer;
    PC.m_bTopdown = 1;
    PC.m_uMemSize = IG_3D_GAME_POOL_SIZE;
    IGGame_OnStartup(&PC);

    ig_start_timer(1, ig_timer_callback);    
}


/*****************************************************************************
 * FUNCTION
 *  IGP_OnGameDeactivated
 * DESCRIPTION
 *  exit game screen
 * PARAMETERS
 *  void
 * RETURNS
 *  void
 *****************************************************************************/
static void IGP_OnGameDeactivated(void)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/

    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
    // stop video if video playback is ongoing
    IGSystem_StopVideo();
    
    /* stop game */
    IGGame_OnShutdown();

    /* Free Memory */
    if (ig_engine_mem_buffer!=NULL)
    {
		mmi_frm_asm_free_r(g_IGAppID, ig_engine_mem_buffer);
		ig_engine_mem_buffer = NULL;
    }
    
    ig_cancel_timer(ig_timer_callback);

    /* restore timer to default accuracy */
    UI_enable_alignment_timers();

    /* disable faster key handling */
    mmi_frm_set_key_handle_in_high_frequency(MMI_FALSE);

    /* re-enable the keypad tone */
    mmi_frm_kbd_set_tone_state(MMI_KEY_TONE_ENABLED);

    /* stop all playing audio */
    mdi_audio_stop_string();

    /* resume background play */
    mdi_audio_resume_background_play();

#ifdef __MMI_SUBLCD__
    /* resume sublcd */
    GoBackSubLCDHistory();
#endif /* __MMI_SUBLCD__ */ 

    /* let MMI can sleep */
    //srv_backlight_turn_off();
}

extern void IG1(void);
extern void IG2(void);

////////////////////////////////////////////////////////////////////////
static void ig_memory_success_callback(void)
{
    /*----------------------------------------------------------------*/
	/* Local Variables 											   */
	/*----------------------------------------------------------------*/
	
	/*----------------------------------------------------------------*/
	/* Code Body													   */
	/*----------------------------------------------------------------*/
    ig_engine_mem_buffer = mmi_frm_asm_alloc_r(g_IGAppID, IG_3D_GAME_POOL_SIZE);
	MMI_ASSERT(ig_engine_mem_buffer);  //impossible
	mmi_entry_ig_scrn();
}

static void mmi_exit_ig_scrn(void)
{
	//IG implement to free all resource and memory
	IGP_OnGameDeactivated();
}

static void mmi_entry_ig_scrn(void)
{
    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
	if (ig_engine_mem_buffer == NULL) 
    {
        ig_engine_mem_buffer = mmi_frm_asm_alloc_r(g_IGAppID, IG_3D_GAME_POOL_SIZE);

		if (ig_engine_mem_buffer == NULL)
        {
            mmi_frm_appmem_prompt_to_release_mem(g_IGAppID, IMG_ID_3D_GAME_INTERGRAFX, IG_3D_GAME_POOL_SIZE, ig_memory_success_callback);
            return;
        }
        MMI_ASSERT(ig_engine_mem_buffer);  //impossible
    }
	
    if (mmi_frm_scrn_enter(g_IGAppID, SCR_ID_IG_MAIN, (FuncPtr)mmi_exit_ig_scrn,(FuncPtr)mmi_entry_ig_scrn, MMI_FRM_FULL_SCRN))
    {
	    IGP_OnGameActivated();
    }
}

mmi_ret mmi_ig_group_proc(mmi_event_struct *evt)
{
    switch(evt->evt_id)
    {
	    default:
		    break;
    }
    return MMI_RET_OK;
}

/*****************************************************************************
 * FUNCTION
 *  mmi_fng_entry_intergrafx_3d_game
 * DESCRIPTION
 *  3d game entry function
 * PARAMETERS
 *  void
 * RETURNS
 *  void
 *****************************************************************************/
void mmi_fng_entry_3d_game_intergrafx(void)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/

    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
#if	defined(__MMI_APP_MANAGER_SUPPORT__)
    g_IGAppID = APP_IG_3DGAME;
#else
    g_IGAppID = APP_FUNANDGAMES;
#endif



    /* add intergrafx 3d game launcher here */
    mmi_frm_group_create(GRP_ID_ROOT,g_IGAppID, mmi_ig_group_proc, NULL);
    mmi_frm_group_enter(g_IGAppID, MMI_FRM_NODE_SMART_CLOSE_FLAG);
	
    mmi_entry_ig_scrn(); 

}
#endif //__VENUS_3D_UI_ENGINE__
#endif //__MMI_3D_GAME_INTERGRAFX__
